# Инструкция по проверке исправления высоты таблицы Шахматка

## Быстрый старт

### 1. Запустить dev server
```bash
npm run dev:local
```
Откроется: http://localhost:5173

### 2. Перейти на страницу Шахматка
- В меню выбрать: **Документы → Шахматка**

### 3. Применить фильтры
- Выбрать проект
- Нажать кнопку "Применить фильтры"
- Убедиться, что таблица загружена с данными

---

## Проверка на разных масштабах

### Scale 0.7 (70%)
1. В правом верхнем углу выбрать масштаб **0.7**
2. **Проверить:**
   - ✅ Таблица занимает максимум высоты
   - ✅ Зазор между таблицей и пагинацией ~60px
   - ✅ Пагинация видна без прокрутки
   - ✅ Нет двойного вертикального скролла

### Scale 0.8 (80%)
1. Выбрать масштаб **0.8**
2. **Проверить:**
   - ✅ Таблица занимает максимум высоты
   - ✅ Зазор между таблицей и пагинацией ~60px
   - ✅ Пагинация видна без прокрутки
   - ✅ Нет двойного вертикального скролла

### Scale 0.9 (90%)
1. Выбрать масштаб **0.9**
2. **Проверить:**
   - ✅ Таблица занимает максимум высоты
   - ✅ Зазор между таблицей и пагинацией ~60px
   - ✅ Пагинация видна без прокрутки
   - ✅ Нет двойного вертикального скролла

### Scale 1.0 (100%)
1. Выбрать масштаб **1.0**
2. **Проверить:**
   - ✅ Таблица занимает максимум высоты
   - ✅ Зазор между таблицей и пагинацией ~60px
   - ✅ Пагинация видна без прокрутки
   - ✅ Нет двойного вертикального скролла

---

## Визуальная проверка (опционально)

### Открыть HTML прототип
Открыть файл в браузере: `temp/test-table-height.html`

**Что проверить:**
1. Переключать масштабы через кнопки (0.7, 0.8, 0.9, 1.0)
2. Смотреть на панель информации:
   - **Зазор до пагинации** должен быть 10-100px (зеленый цвет)
   - **Использование высоты таблицы** должно быть ≥70% (зеленый цвет)
3. Если значения красные - есть проблема

---

## Автоматическое тестирование (опционально)

### Запустить Playwright тест
```bash
# Убедитесь, что dev server запущен на localhost:5173
npx playwright test tests/chessboard-table-height.spec.ts
```

**Что проверяет тест:**
- Таблица занимает минимум 70% доступной высоты
- Зазор между таблицей и пагинацией 10-100px
- Разница зазоров между масштабами ≤20px
- Пагинация всегда видна в viewport

---

## Что было исправлено?

### Проблема (ДО)
При масштабах 0.7, 0.8, 0.9 таблица оставляла много пустого места (200-300px) до блока пагинации.

```
┌────────────────────┐
│ Заголовок          │
│ Фильтры            │
├────────────────────┤
│ Таблица            │
│                    │
├────────────────────┤
│ ⬇️ ОГРОМНЫЙ ЗАЗОР  │
│ 200-300px ❌       │
├────────────────────┤
│ Пагинация          │
└────────────────────┘
```

### Решение (ПОСЛЕ)
Использована динамическая высота через `flex: 1` + `height: 100%`.

```
┌────────────────────┐
│ Заголовок          │
│ Фильтры            │
├────────────────────┤
│ Таблица            │
│ (максимум высоты)  │
│                    │
│                    │
│                    │
├────────────────────┤
│ Зазор ~60px ✅     │
├────────────────────┤
│ Пагинация          │
└────────────────────┘
```

---

## Измененные файлы

### Основные изменения
- `src/pages/documents/Chessboard/components/ChessboardTable.tsx`
  - Удалена функция `getTableVerticalOffset`
  - Изменена конфигурация scroll.y: `calc(100vh - Npx)` → `100%`
  - Исправлен CSS: `.ant-table-container { height: 100% }`

### Документация
- `temp/chessboard-table-scroll-backup.md` - обновлена история изменений
- `temp/CHESSBOARD_TABLE_HEIGHT_FIX_REPORT.md` - полный отчет о проблеме и решении
- `temp/comparison-before-after.md` - визуальное сравнение "до" и "после"

### Тесты
- `tests/chessboard-table-height.spec.ts` - автоматический тест Playwright
- `temp/test-table-height.html` - HTML прототип для визуальной проверки

---

## Чек-лист проверки

- [ ] Dev server запущен
- [ ] Страница Шахматка открыта
- [ ] Проект выбран, фильтры применены
- [ ] Scale 0.7: таблица занимает максимум высоты, зазор ~60px
- [ ] Scale 0.8: таблица занимает максимум высоты, зазор ~60px
- [ ] Scale 0.9: таблица занимает максимум высоты, зазор ~60px
- [ ] Scale 1.0: таблица занимает максимум высоты, зазор ~60px
- [ ] Нет двойного вертикального скролла
- [ ] Пагинация всегда видна

---

## Обратная связь

Если после исправления проблема остается:
1. Проверить, что изменения применены (перезагрузить страницу)
2. Открыть DevTools и проверить CSS `.chessboard-table .ant-table-container`
3. Убедиться, что `height: 100%` применен, а не `calc(100vh - 300px)`
4. Проверить консоль браузера на ошибки

---

**Дата:** 2025-09-30
**Статус:** ИСПРАВЛЕНИЕ ПРИМЕНЕНО ✅