# –°–∏—Å—Ç–µ–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –í–û–† (–í–µ–¥–æ–º–æ—Å—Ç—å –æ–±—ä–µ–º–∞ —Ä–∞–±–æ—Ç)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –í–û–† —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, inline-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω –∏ –æ–±—ä–µ–º–æ–≤.

## üóÑÔ∏è –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-–º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü:

```bash
psql "$DATABASE_URL" -f sql/001_create_vor_editable_tables.sql
```

–°–æ–∑–¥–∞—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã:
- `vor_works` - —Ä–∞–±–æ—Ç—ã –í–û–† —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ —Ä–∞—Å—Ü–µ–Ω–∫–∞–º
- `vor_materials` - –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Ä–∞–±–æ—Ç —Å —Ü–µ–Ω–∞–º–∏ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü
\d vor_works
\d vor_materials

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤
\di vor_*
```

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### Entity `vor` (FSD —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
```
src/entities/vor/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ vor-api.ts          # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ vor-works-api.ts    # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ä–∞–±–æ—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ vor-materials-api.ts # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # –≠–∫—Å–ø–æ—Ä—Ç API —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ types.ts            # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # –≠–∫—Å–ø–æ—Ä—Ç —Ç–∏–ø–æ–≤
‚îî‚îÄ‚îÄ index.ts                # –ü—É–±–ª–∏—á–Ω—ã–π API entity
```

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
```
vor (–í–û–†)
 ‚Üì vor_id
vor_works (—Ä–∞–±–æ—Ç—ã –í–û–†) ‚Üê rate_id ‚Üí rates (—Ä–∞—Å—Ü–µ–Ω–∫–∏)
 ‚Üì vor_work_id                     ‚Üì unit_id ‚Üí units
vor_materials (–º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ä–∞–±–æ—Ç—ã) ‚Üê unit_id ‚Üí units
```

**–í–∞–∂–Ω–æ**: –ü–æ–ª—è `name` –∏ `unit_id` —É–±—Ä–∞–Ω—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `vor_works` –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î. –ù–∞–∑–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç –∏ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ–ª—É—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JOIN —Å —Ç–∞–±–ª–∏—Ü–µ–π `rates`.

## üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã
- **view** - –ø—Ä–æ—Å–º–æ—Ç—Ä (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
- **edit** - inline —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **add** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–∞–±–æ—Ç –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- **delete** - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç
- –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É" ‚Üí –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
- –í—ã–±–æ—Ä –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ `rates` —Å –ø–æ–∏—Å–∫–æ–º
- –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- –ö–Ω–æ–ø–∫–∞ "+ –ú–∞—Ç–µ—Ä–∏–∞–ª" –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–∞–±–æ—Ç—ã
- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –∏–∑ `supplier_names.name`
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –Ω–∞–∑–≤–∞–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ —Ü–µ–Ω—ã

### 4. –†–∞—Å—á–µ—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞

#### –î–ª—è —Ä–∞–±–æ—Ç:
- **–¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É**: `base_rate √ó coefficient` (–≤ runtime)
- **–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã**: `(base_rate √ó coefficient) √ó quantity`

#### –î–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:
- **–°—Ç–æ–∏–º–æ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∞**: `price √ó quantity`

#### –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å—Ü–µ–Ω–æ–∫:
- –ï—Å–ª–∏ `base_rate > 0` ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º `coefficient`
- –ï—Å–ª–∏ `base_rate = 0` ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º `work_price` –∫–∞–∫ –∞–±—Å–æ–ª—é—Ç–Ω—É—é —Ü–µ–Ω—É

## üé® UI/UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –†–µ–∂–∏–º–Ω—ã–µ –∫–Ω–æ–ø–∫–∏:
- **–†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞**: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel, –ö–æ–º–ø–ª–µ–∫—Ç
- **–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É, –£–¥–∞–ª–∏—Ç—å, –°–æ—Ö—Ä–∞–Ω–∏—Ç—å, –û—Ç–º–µ–Ω–∞
- **–†–µ–∂–∏–º —É–¥–∞–ª–µ–Ω–∏—è**: –£–¥–∞–ª–∏—Ç—å (N), –û—Ç–º–µ–Ω–∞

### –¢–∞–±–ª–∏—Ü–∞:
- **–ö–æ–ª–æ–Ω–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π** –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ß–µ–∫–±–æ–∫—Å—ã** –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ä–µ–∂–∏–º–µ —É–¥–∞–ª–µ–Ω–∏—è
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: —Ä–∞–±–æ—Ç—ã ‚Üí –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏
- **–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞**: —Ä–∞–±–æ—Ç—ã –≤—ã–¥–µ–ª–µ–Ω—ã —Å–∏—Ä–µ–Ω–µ–≤—ã–º —Ñ–æ–Ω–æ–º

### –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞:
- **AddWorkModal** - –≤—ã–±–æ—Ä —Ä–∞—Å—Ü–µ–Ω–æ–∫ —Å –ø–æ–∏—Å–∫–æ–º, –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- **AddMaterialModal** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–æ–º

## üîå API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
```typescript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
const data = await getVorTableData(vor_id)

// –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
await createVorWork({
  vor_id,
  rate_id,
  name,
  unit_id,
  quantity: 1,
  coefficient: 1.0,
  base_rate
})

// –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
await createVorMaterial({
  vor_work_id,
  supplier_material_name,
  unit_id,
  quantity,
  price
})
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤:
```typescript
// –†–∞—Å—Ü–µ–Ω–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞
const rates = await getRatesOptions()

// –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ —Å –ø–æ–∏—Å–∫–æ–º
const suppliers = await getSupplierNamesOptions(searchTerm)

// –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
const units = await getUnitsOptions()
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–ü—Ä–æ—Å–º–æ—Ç—Ä –í–û–†"
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
1. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É"
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å—Ü–µ–Ω–∫–∏ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
3. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å (N)"

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
1. –í —Å—Ç—Ä–æ–∫–µ —Ä–∞–±–æ—Ç—ã –Ω–∞–∂–º–∏—Ç–µ "+ –ú–∞—Ç–µ—Ä–∏–∞–ª"
2. –í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª
3. –£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ü–µ–Ω—É
4. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª"

### 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
1. –í–Ω–µ—Å–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

### 5. –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–£–¥–∞–ª–∏—Ç—å"
2. –í—ã–±–µ—Ä–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å—ã
3. –ù–∞–∂–º–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å (N)"

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Lazy loading** –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ TanStack Query
- **Batch –æ–ø–µ—Ä–∞—Ü–∏–∏** –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –ë–î –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

- **–°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å** –≤—Å–µ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –í–û–†
- **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** –º–µ–∂–¥—É —Å—Ç–∞—Ä—ã–º–∏ –∏ –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ `isEditingEnabled`
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ Excel
- **–ï–¥–∏–Ω—ã–π UI** –≤ —Å—Ç–∏–ª–µ —à–∞–±–ª–æ–Ω–∞ "–î–æ–∫—É–º–µ–Ω—Ç"

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
```typescript
const [viewMode, setViewMode] = useState<ViewMode>('view')
const [isEditingEnabled, setIsEditingEnabled] = useState(false)
const [editableVorData, setEditableVorData] = useState<VorTableItem[]>([])
```

### –¢–∏–ø–∏–∑–∞—Ü–∏—è:
- –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö API —Ñ—É–Ω–∫—Ü–∏–π
- –†–∞–∑–¥–µ–ª—å–Ω—ã–µ DTO –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ message API
- –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è